<link rel="import" href="../polymer/polymer-element.html">
<script src="node_modules/timeago.js/dist/timeago.min.js"></script>


<dom-module id="fuzzy-date">
    <template>
        <style>
            :host {
                display: block;
            }
        </style>
        <span>[[_format(date)]]</span>
    </template>

    <script>
        /**
         * `fuzzy-date`
         *
         *
         * @customElement
         * @polymer
         * @demo demo/index.html
         */

        class FuzzyDate extends Polymer.Element {
            static get is() {
                return 'fuzzy-date';
            }

            static get properties() {
                return {
                    date: {
                        type: String
                    },
                    days: {
                        type: Number,
                        value: 6,
                        reflectToAttribute: true
                    }
                };
            }

            _format(date) {

                let givenDate = new Date(date);
                if (isNaN(givenDate.getTime())) {
                    return '';
                }

    //attribuut toevoegen waarmee je aantal dagen/maanden die worden weergegeven kan kiezen
                let today = new Date();
                let daysAgo = this._daysBetween(givenDate, today);

                console.log(this.days);
                if(daysAgo < this.days) {
                    return timeago().format(date);
                }
                else {
                    return givenDate.toDateString();
                }
            }

            _daysBetween(start, end) {
                const millisecondsPerDay = 24 * 60 * 60 * 1000;
                return Math.floor((end - start) / millisecondsPerDay);
            }
        }
        window.customElements.define(FuzzyDate.is, FuzzyDate);
    </script>
</dom-module>
